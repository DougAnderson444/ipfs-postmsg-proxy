{"version":3,"sources":["../../src/server/index.js"],"names":["closeProxyServer","getIpfs","opts","pre","preObj","fnName","ipfs","bitswap","block","bootstrap","config","dag","dht","dns","files","id","key","name","object","pin","pubsub","repo","resolve","stats","stop","swarm","version","Object","assign","obj","Promise","all","keys","map","k","close"],"mappings":"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","file":"index.js","sourcesContent":["import { expose } from 'postmsg-rpc'\r\nimport { pre } from 'prepost'\r\nimport createBitswap from './bitswap'\r\nimport createBlock from './block'\r\nimport createBootstrap from './bootstrap'\r\nimport createConfig from './config'\r\nimport createDag from './dag'\r\nimport createDht from './dht'\r\nimport createFiles from './files'\r\nimport createKey from './key'\r\nimport createLs from './ls'\r\nimport createName from './name'\r\nimport createObject from './object'\r\nimport createPin from './pin'\r\nimport createPing from './ping'\r\nimport createPubsub from './pubsub'\r\nimport createRepo from './repo'\r\nimport createStats from './stats'\r\nimport createSwarm from './swarm'\r\n\r\nexport default (getIpfs, opts) => {\r\n  opts = opts || {}\r\n\r\n  if (typeof opts.pre !== 'function') {\r\n    const preObj = opts.pre || {}\r\n    opts.pre = (fnName) => preObj[fnName]\r\n  }\r\n\r\n  const ipfs = {\r\n    bitswap: createBitswap(getIpfs, opts),\r\n    block: createBlock(getIpfs, opts),\r\n    bootstrap: createBootstrap(getIpfs, opts),\r\n    config: createConfig(getIpfs, opts),\r\n    dag: createDag(getIpfs, opts),\r\n    dht: createDht(getIpfs, opts),\r\n    dns: expose('ipfs.dns', pre(\r\n      opts.pre('dns'),\r\n      (...args) => getIpfs().dns(...args)\r\n    ), opts),\r\n    files: createFiles(getIpfs, opts),\r\n    id: expose('ipfs.id', pre(\r\n      opts.pre('id'),\r\n      () => getIpfs().id()\r\n    ), opts),\r\n    key: createKey(getIpfs, opts),\r\n    name: createName(getIpfs, opts),\r\n    object: createObject(getIpfs, opts),\r\n    pin: createPin(getIpfs, opts),\r\n    pubsub: createPubsub(getIpfs, opts),\r\n    repo: createRepo(getIpfs, opts),\r\n    resolve: expose('ipfs.resolve', pre(\r\n      opts.pre('resolve'),\r\n      (...args) => getIpfs().resolve(...args)\r\n    ), opts),\r\n    stats: createStats(getIpfs, opts),\r\n    stop: expose('ipfs.stop', pre(\r\n      opts.pre('stop'),\r\n      () => getIpfs().stop()\r\n    ), opts),\r\n    swarm: createSwarm(getIpfs, opts),\r\n    version: expose('ipfs.version', pre(\r\n      opts.pre('version'),\r\n      () => getIpfs().version()\r\n    ), opts)\r\n  }\r\n\r\n  Object.assign(\r\n    ipfs,\r\n    createLs(getIpfs, opts),\r\n    createPing(getIpfs, opts)\r\n  )\r\n\r\n  return ipfs\r\n}\r\n\r\nexport function closeProxyServer (obj) {\r\n  return Promise.all(\r\n    Object.keys(obj).map((k) => {\r\n      if (obj[k].close) return Promise.resolve(obj[k].close())\r\n      return Promise.resolve(closeProxyServer(obj[k]))\r\n    })\r\n  )\r\n}\r\n"]}