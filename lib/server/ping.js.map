{"version":3,"sources":["../../src/server/ping.js"],"names":["getIpfs","opts","ping","pre","pingPullStream","res","Promise","resolve","readFnName","PMS","sink"],"mappings":";;;;;;kBAOe,UAAUA,OAAV,EAAmBC,IAAnB,EAAyB;AACtC,SAAO;AACLC,UAAM,wBAAO,WAAP,EAAoB,kBACxBD,KAAKE,GAAL,CAAS,MAAT,CADwB,EAExB;AAAA;;AAAA,aAAa,uBAAUD,IAAV,2BAAb;AAAA,KAFwB,CAApB,EAGHD,IAHG,CADD;AAKLG,oBAAgB,wBAAO,qBAAP,EAA8B,kBAC5CH,KAAKE,GAAL,CAAS,gBAAT,CAD4C,EAE5C,mBACE;AAAA;;AAAA,aAAa,wBAAUC,cAAV,4BAAb;AAAA,KADF,EAEE,UAACC,GAAD;AAAA,aAAS,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAChC,YAAMC,aAAa,wBAAnB;AACA,kCAAKH,GAAL,EAAUI,4BAAIC,IAAJ,CAASF,UAAT,EAAqBP,IAArB,CAAV;AACAM,gBAAQ,8BAAeC,UAAf,CAAR;AACD,OAJQ,CAAT;AAAA,KAFF,CAF4C,CAA9B,EAUbP,IAVa;AALX,GAAP;AAiBD,C;;AAzBD;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA","file":"ping.js","sourcesContent":["import { expose } from 'postmsg-rpc'\r\nimport { pre, post } from 'prepost'\r\nimport pull from 'pull-stream'\r\nimport PMS from 'pull-postmsg-stream'\r\nimport shortid from 'shortid'\r\nimport { functionToJson } from '../serialization/function'\r\n\r\nexport default function (getIpfs, opts) {\r\n  return {\r\n    ping: expose('ipfs.ping', pre(\r\n      opts.pre('ping'),\r\n      (...args) => getIpfs().ping(...args)\r\n    ), opts),\r\n    pingPullStream: expose('ipfs.pingPullStream', pre(\r\n      opts.pre('pingPullStream'),\r\n      post(\r\n        (...args) => getIpfs().pingPullStream(...args),\r\n        (res) => new Promise((resolve) => {\r\n          const readFnName = shortid()\r\n          pull(res, PMS.sink(readFnName, opts))\r\n          resolve(functionToJson(readFnName))\r\n        })\r\n      )\r\n    ), opts)\r\n  }\r\n}\r\n"]}