{"version":3,"sources":["../../src/client/ping.js"],"names":["opts","api","ping","callbackify","variadic","pingPullStream","res","PMS","source","name","deferred","defer","then","resolve","catch","err","abort","pingReadableStream","toStream","arguments"],"mappings":";;;;;;kBAOe,UAAUA,IAAV,EAAgB;AAC7B,MAAMC,MAAM;AACVC,UAAMC,sBAAYC,QAAZ,CAAqB,wBAAO,WAAP,EAAoBJ,IAApB,CAArB,CADI;AAEVK,oBAAiB,YAAM;AACrB,UAAMA,iBAAiB,mBACrB,wBAAO,qBAAP,EAA8BL,IAA9B,CADqB,EAErB,UAACM,GAAD;AAAA,eAASC,4BAAIC,MAAJ,CAAWF,IAAIG,IAAf,EAAqBT,IAArB,CAAT;AAAA,OAFqB,CAAvB;;AAKA,aAAO,YAAa;AAClB,YAAMU,WAAWC,oBAAMH,MAAN,EAAjB;;AAEAH,mDACGO,IADH,CACQ,UAACN,GAAD;AAAA,iBAASI,SAASG,OAAT,CAAiBP,GAAjB,CAAT;AAAA,SADR,EAEGQ,KAFH,CAES,UAACC,GAAD;AAAA,iBAASL,SAASM,KAAT,CAAeD,GAAf,CAAT;AAAA,SAFT;;AAIA,eAAOL,QAAP;AACD,OARD;AASD,KAfe,EAFN;AAkBVO,sBAlBU,gCAkBY;AACpB,aAAOC,6BAASV,MAAT,CAAgBP,IAAII,cAAJ,YAAsBc,SAAtB,CAAhB,CAAP;AACD;AApBS,GAAZ;;AAuBA,SAAOlB,GAAP;AACD,C;;AAhCD;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA","file":"ping.js","sourcesContent":["import { caller } from 'postmsg-rpc'\r\nimport callbackify from 'callbackify'\r\nimport defer from 'pull-defer'\r\nimport toStream from 'pull-stream-to-stream'\r\nimport PMS from 'pull-postmsg-stream'\r\nimport { post } from 'prepost'\r\n\r\nexport default function (opts) {\r\n  const api = {\r\n    ping: callbackify.variadic(caller('ipfs.ping', opts)),\r\n    pingPullStream: (() => {\r\n      const pingPullStream = post(\r\n        caller('ipfs.pingPullStream', opts),\r\n        (res) => PMS.source(res.name, opts)\r\n      )\r\n\r\n      return (...args) => {\r\n        const deferred = defer.source()\r\n\r\n        pingPullStream(...args)\r\n          .then((res) => deferred.resolve(res))\r\n          .catch((err) => deferred.abort(err))\r\n\r\n        return deferred\r\n      }\r\n    })(),\r\n    pingReadableStream () {\r\n      return toStream.source(api.pingPullStream(...arguments))\r\n    }\r\n  }\r\n\r\n  return api\r\n}\r\n"]}